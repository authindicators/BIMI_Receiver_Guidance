<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head profile="http://www.w3.org/2006/03/hcard http://dublincore.org/documents/2008/08/04/dc-html/">
  <meta http-equiv="Content-Type" content="text/html; charset=us-ascii" />

  <title>Receivers Guidance for Implementing Branded Indicators for Message Identification (BIMI)</title>

  <style type="text/css" title="Xml2Rfc (sans serif)">
  /*<![CDATA[*/
	  a {
	  text-decoration: none;
	  }
      /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
      a.info {
          /* This is the key. */
          position: relative;
          z-index: 24;
          text-decoration: none;
      }
      a.info:hover {
          z-index: 25;
          color: #FFF; background-color: #900;
      }
      a.info span { display: none; }
      a.info:hover span.info {
          /* The span will display just on :hover state. */
          display: block;
          position: absolute;
          font-size: smaller;
          top: 2em; left: -5em; width: 15em;
          padding: 2px; border: 1px solid #333;
          color: #900; background-color: #EEE;
          text-align: left;
      }
	  a.smpl {
	  color: black;
	  }
	  a:hover {
	  text-decoration: underline;
	  }
	  a:active {
	  text-decoration: underline;
	  }
	  address {
	  margin-top: 1em;
	  margin-left: 2em;
	  font-style: normal;
	  }
	  body {
	  color: black;
	  font-family: verdana, helvetica, arial, sans-serif;
	  font-size: 10pt;
	  max-width: 55em;
	  
	  }
	  cite {
	  font-style: normal;
	  }
	  dd {
	  margin-right: 2em;
	  }
	  dl {
	  margin-left: 2em;
	  }
	
	  ul.empty {
	  list-style-type: none;
	  }
	  ul.empty li {
	  margin-top: .5em;
	  }
	  dl p {
	  margin-left: 0em;
	  }
	  dt {
	  margin-top: .5em;
	  }
	  h1 {
	  font-size: 14pt;
	  line-height: 21pt;
	  page-break-after: avoid;
	  }
	  h1.np {
	  page-break-before: always;
	  }
	  h1 a {
	  color: #333333;
	  }
	  h2 {
	  font-size: 12pt;
	  line-height: 15pt;
	  page-break-after: avoid;
	  }
	  h3, h4, h5, h6 {
	  font-size: 10pt;
	  page-break-after: avoid;
	  }
	  h2 a, h3 a, h4 a, h5 a, h6 a {
	  color: black;
	  }
	  img {
	  margin-left: 3em;
	  }
	  li {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol p {
	  margin-left: 0em;
	  }
	  p {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  pre {
	  margin-left: 3em;
	  background-color: lightyellow;
	  padding: .25em;
	  }
	  pre.text2 {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f0f0f0;
	  width: 69em;
	  }
	  pre.inline {
	  background-color: white;
	  padding: 0em;
	  }
	  pre.text {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  width: 69em;
	  }
	  pre.drawing {
	  border-style: solid;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  padding: 2em;
	  }
	  table {
	  margin-left: 2em;
	  }
	  table.tt {
	  vertical-align: top;
	  }
	  table.full {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.headers {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.tt td {
	  vertical-align: top;
	  }
	  table.full td {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.tt th {
	  vertical-align: top;
	  }
	  table.full th {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.headers th {
	  border-style: none none inset none;
	  border-width: 1px;
	  }
	  table.left {
	  margin-right: auto;
	  }
	  table.right {
	  margin-left: auto;
	  }
	  table.center {
	  margin-left: auto;
	  margin-right: auto;
	  }
	  caption {
	  caption-side: bottom;
	  font-weight: bold;
	  font-size: 9pt;
	  margin-top: .5em;
	  }
	
	  table.header {
	  border-spacing: 1px;
	  width: 95%;
	  font-size: 10pt;
	  color: white;
	  }
	  td.top {
	  vertical-align: top;
	  }
	  td.topnowrap {
	  vertical-align: top;
	  white-space: nowrap; 
	  }
	  table.header td {
	  background-color: gray;
	  width: 50%;
	  }
	  table.header a {
	  color: white;
	  }
	  td.reference {
	  vertical-align: top;
	  white-space: nowrap;
	  padding-right: 1em;
	  }
	  thead {
	  display:table-header-group;
	  }
	  ul.toc, ul.toc ul {
	  list-style: none;
	  margin-left: 1.5em;
	  margin-right: 0em;
	  padding-left: 0em;
	  }
	  ul.toc li {
	  line-height: 150%;
	  font-weight: bold;
	  font-size: 10pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  ul.toc li li {
	  line-height: normal;
	  font-weight: normal;
	  font-size: 9pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  li.excluded {
	  font-size: 0pt;
	  }
	  ul p {
	  margin-left: 0em;
	  }
	
	  .comment {
	  background-color: yellow;
	  }
	  .center {
	  text-align: center;
	  }
	  .error {
	  color: red;
	  font-style: italic;
	  font-weight: bold;
	  }
	  .figure {
	  font-weight: bold;
	  text-align: center;
	  font-size: 9pt;
	  }
	  .filename {
	  color: #333333;
	  font-weight: bold;
	  font-size: 12pt;
	  line-height: 21pt;
	  text-align: center;
	  }
	  .fn {
	  font-weight: bold;
	  }
	  .hidden {
	  display: none;
	  }
	  .left {
	  text-align: left;
	  }
	  .right {
	  text-align: right;
	  }
	  .title {
	  color: #990000;
	  font-size: 18pt;
	  line-height: 18pt;
	  font-weight: bold;
	  text-align: center;
	  margin-top: 36pt;
	  }
	  .vcardline {
	  display: block;
	  }
	  .warning {
	  font-size: 14pt;
	  background-color: yellow;
	  }
	
	
	  @media print {
	  .noprint {
		display: none;
	  }
	
	  a {
		color: black;
		text-decoration: none;
	  }
	
	  table.header {
		width: 90%;
	  }
	
	  td.header {
		width: 50%;
		color: black;
		background-color: white;
		vertical-align: top;
		font-size: 12pt;
	  }
	
	  ul.toc a::after {
		content: leader('.') target-counter(attr(href), page);
	  }
	
	  ul.ind li li a {
		content: target-counter(attr(href), page);
	  }
	
	  .print2col {
		column-count: 2;
		-moz-column-count: 2;
		column-fill: auto;
	  }
	  }
	
	  @page {
	  @top-left {
		   content: "Internet-Draft"; 
	  } 
	  @top-right {
		   content: "December 2010"; 
	  } 
	  @top-center {
		   content: "Abbreviated Title";
	  } 
	  @bottom-left {
		   content: "Doe"; 
	  } 
	  @bottom-center {
		   content: "Expires June 2011"; 
	  } 
	  @bottom-right {
		   content: "[Page " counter(page) "]"; 
	  } 
	  }
	
	  @page:first { 
		@top-left {
		  content: normal;
		}
		@top-right {
		  content: normal;
		}
		@top-center {
		  content: normal;
		}
	  }
  /*]]>*/
  </style>

  <link href="#rfc.toc" rel="Contents">
<link href="#rfc.section.1" rel="Chapter" title="1 Introduction">
<link href="#rfc.section.1.1" rel="Chapter" title="1.1 Terminology">
<link href="#rfc.section.2" rel="Chapter" title="2 Goals for BIMI">
<link href="#rfc.section.3" rel="Chapter" title="3 Should your site implement BIMI?">
<link href="#rfc.section.4" rel="Chapter" title="4 Terminology">
<link href="#rfc.section.5" rel="Chapter" title="5 Site implementations">
<link href="#rfc.section.6" rel="Chapter" title="6 Validation of a BIMI message">
<link href="#rfc.section.6.1" rel="Chapter" title="6.1 BIMI Site Requirements">
<link href="#rfc.section.6.2" rel="Chapter" title="6.2 Verified Mark Certificate (VMC) Validation">
<link href="#rfc.section.7" rel="Chapter" title="7 Communicating BIMI results between the MTA and the MUA">
<link href="#rfc.section.7.1" rel="Chapter" title="7.1 Image Retrieval">
<link href="#rfc.section.7.2" rel="Chapter" title="7.2 TTL of cached images">
<link href="#rfc.section.7.3" rel="Chapter" title="7.3 Image Display">
<link href="#rfc.section.7.4" rel="Chapter" title="7.4 Privacy Concerns">
<link href="#rfc.section.7.5" rel="Chapter" title="7.5 Basic flow example">
<link href="#rfc.section.7.6" rel="Chapter" title="7.6 Message Classification">
<link href="#rfc.section.8" rel="Chapter" title="8 Domain Reputation">
<link href="#rfc.section.8.1" rel="Chapter" title="8.1 Rolling up based upon domain vs organizational domain">
<link href="#rfc.section.8.2" rel="Chapter" title="8.2 VMC Root of Trust">
<link href="#rfc.section.9" rel="Chapter" title="9 BIMI Playbook Checklist">
<link href="#rfc.section.10" rel="Chapter" title="10 Public documentation">
<link href="#rfc.section.10.1" rel="Chapter" title="10.1 Documentation For Brands:">
<link href="#rfc.section.10.2" rel="Chapter" title="10.2 Documentation For Users:">
<link href="#rfc.section.11" rel="Chapter" title="11 Appendix">
<link href="#rfc.section.11.1" rel="Chapter" title="11.1 Glossary">
<link href="#rfc.section.12" rel="Chapter" title="12 Contributors">
<link href="#rfc.section.13" rel="Chapter" title="13 References">
<link href="#rfc.references" rel="Chapter" title="14 Normative References">
<link href="#rfc.authors" rel="Chapter">


  <meta name="generator" content="xml2rfc version 2.15.5 - https://tools.ietf.org/tools/xml2rfc" />
  <link rel="schema.dct" href="http://purl.org/dc/terms/" />

  <meta name="dct.creator" content="Brotman, A., Zink, T., and M. Bradshaw" />
  <meta name="dct.identifier" content="urn:ietf:id:draft-ietf-bimi-receiver-guidance" />
  <meta name="dct.issued" scheme="ISO8601" content="2019-08-05" />
  <meta name="dct.abstract" content="This document is meant to assist receivers or other mailbox providers by providing guidance to implementing Brand Indicators for Message Identification (BIMI). This document is a companion to the main BIMI drafts which should first be consulted and reviewed.  " />
  <meta name="description" content="This document is meant to assist receivers or other mailbox providers by providing guidance to implementing Brand Indicators for Message Identification (BIMI). This document is a companion to the main BIMI drafts which should first be consulted and reviewed.  " />

</head>

<body>

  <table class="header">
    <tbody>
    
    	<tr>
<td class="left">Network Working Group</td>
<td class="right">A. Brotman</td>
</tr>
<tr>
<td class="left">Internet-Draft</td>
<td class="right">Comcast</td>
</tr>
<tr>
<td class="left">Intended status: Best Current Practice</td>
<td class="right">T. Zink</td>
</tr>
<tr>
<td class="left">Expires: February 6, 2020</td>
<td class="right">Zink Magical Contraptions</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">M. Bradshaw</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">Fastmail</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">August 5, 2019</td>
</tr>

    	
    </tbody>
  </table>

  <p class="title">Receivers Guidance for Implementing Branded Indicators for Message Identification (BIMI)<br />
  <span class="filename">draft-ietf-bimi-receiver-guidance</span></p>
  
  <h1 id="rfc.abstract"><a href="#rfc.abstract">Abstract</a></h1>
<p>This document is meant to assist receivers or other mailbox providers by providing guidance to implementing Brand Indicators for Message Identification (BIMI). This document is a companion to the main BIMI drafts which should first be consulted and reviewed.  </p>
<h1 id="rfc.status"><a href="#rfc.status">Status of This Memo</a></h1>
<p>This Internet-Draft is submitted in full conformance with the provisions of BCP 78 and BCP 79.</p>
<p>Internet-Drafts are working documents of the Internet Engineering Task Force (IETF).  Note that other groups may also distribute working documents as Internet-Drafts.  The list of current Internet-Drafts is at https://datatracker.ietf.org/drafts/current/.</p>
<p>Internet-Drafts are draft documents valid for a maximum of six months and may be updated, replaced, or obsoleted by other documents at any time.  It is inappropriate to use Internet-Drafts as reference material or to cite them other than as "work in progress."</p>
<p>This Internet-Draft will expire on February 6, 2020.</p>
<h1 id="rfc.copyrightnotice"><a href="#rfc.copyrightnotice">Copyright Notice</a></h1>
<p>Copyright (c) 2019 IETF Trust and the persons identified as the document authors.  All rights reserved.</p>
<p>This document is subject to BCP 78 and the IETF Trust's Legal Provisions Relating to IETF Documents (https://trustee.ietf.org/license-info) in effect on the date of publication of this document.  Please review these documents carefully, as they describe your rights and restrictions with respect to this document.  Code Components extracted from this document must include Simplified BSD License text as described in Section 4.e of the Trust Legal Provisions and are provided without warranty as described in the Simplified BSD License.</p>

  
  <hr class="noprint" />
  <h1 class="np" id="rfc.toc"><a href="#rfc.toc">Table of Contents</a></h1>
  <ul class="toc">

  	<li>1.   <a href="#rfc.section.1">Introduction</a>
</li>
<ul><li>1.1.   <a href="#rfc.section.1.1">Terminology</a>
</li>
</ul><li>2.   <a href="#rfc.section.2">Goals for BIMI</a>
</li>
<li>3.   <a href="#rfc.section.3">Should your site implement BIMI?</a>
</li>
<li>4.   <a href="#rfc.section.4">Terminology</a>
</li>
<li>5.   <a href="#rfc.section.5">Site implementations</a>
</li>
<li>6.   <a href="#rfc.section.6">Validation of a BIMI message</a>
</li>
<ul><li>6.1.   <a href="#rfc.section.6.1">BIMI Site Requirements</a>
</li>
<li>6.2.   <a href="#rfc.section.6.2">Verified Mark Certificate (VMC) Validation</a>
</li>
</ul><li>7.   <a href="#rfc.section.7">Communicating BIMI results between the MTA and the MUA</a>
</li>
<ul><li>7.1.   <a href="#rfc.section.7.1">Image Retrieval</a>
</li>
<li>7.2.   <a href="#rfc.section.7.2">TTL of cached images</a>
</li>
<li>7.3.   <a href="#rfc.section.7.3">Image Display</a>
</li>
<li>7.4.   <a href="#rfc.section.7.4">Privacy Concerns</a>
</li>
<li>7.5.   <a href="#rfc.section.7.5">Basic flow example</a>
</li>
<li>7.6.   <a href="#rfc.section.7.6">Message Classification</a>
</li>
</ul><li>8.   <a href="#rfc.section.8">Domain Reputation</a>
</li>
<ul><li>8.1.   <a href="#rfc.section.8.1">Rolling up based upon domain vs organizational domain</a>
</li>
<li>8.2.   <a href="#rfc.section.8.2">VMC Root of Trust</a>
</li>
</ul><li>9.   <a href="#rfc.section.9">BIMI Playbook Checklist</a>
</li>
<li>10.   <a href="#rfc.section.10">Public documentation</a>
</li>
<ul><li>10.1.   <a href="#rfc.section.10.1">Documentation For Brands:</a>
</li>
<li>10.2.   <a href="#rfc.section.10.2">Documentation For Users:</a>
</li>
</ul><li>11.   <a href="#rfc.section.11">Appendix</a>
</li>
<ul><li>11.1.   <a href="#rfc.section.11.1">Glossary</a>
</li>
</ul><li>12.   <a href="#rfc.section.12">Contributors</a>
</li>
<li>13.   <a href="#rfc.section.13">References</a>
</li>
<li>14.   <a href="#rfc.references">Normative References</a>
</li>
<li><a href="#rfc.authors">Authors' Addresses</a>
</li>


  </ul>

  <h1 id="rfc.section.1">
<a href="#rfc.section.1">1.</a> <a href="#introduction" id="introduction">Introduction</a>
</h1>
<p id="rfc.section.1.p.1">The Brand Indicators for Message Identification (BIMI) specification introduces a method by which Mail User Agent (MUA, e.g., an email client) providers combine DMARC-based message authentication with cryptographic methods to ensure the identity of a sender. If the identity is ensured, the MUA can then retrieve sender-selected iconography to display within the MUA. This displayed iconography grants the sender brand impressions via the BIMI-capable MUA, and should be a driving factor for the adoption of authenticated email.  </p>
<h1 id="rfc.section.1.1">
<a href="#rfc.section.1.1">1.1.</a> <a href="#terminology" id="terminology">Terminology</a>
</h1>
<p id="rfc.section.1.1.p.1">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in [BCP 14] <a href="#RFC2119" class="xref">[RFC2119]</a> <a href="#RFC8174" class="xref">[RFC8174]</a> when, and only when, they appear in all capitals, as shown here.  </p>
<h1 id="rfc.section.2">
<a href="#rfc.section.2">2.</a> <a href="#goals-for-bimi" id="goals-for-bimi">Goals for BIMI</a>
</h1>
<p id="rfc.section.2.p.1">As stated in other BIMI drafts, BIMI intends to advance email authentication by granting a sending party brand impressions as long as the message passes authentication mechanisms and meets other receiver qualifications (reputation, encryption, allow listing, et cetera). DMARC currently has wide adoption by some of the Internet&#8217;s larger brands, but there is still a long tail of small-to-medium size brands (and many large ones) that do not have it.  Because BIMI provides a visual presence in the inbox, and because visual impressions are desirable for brands, BIMI provides an incentive for marketers to spur DMARC adoption, whereas a concern purely from security may not.  </p>
<h1 id="rfc.section.3">
<a href="#rfc.section.3">3.</a> <a href="#should-your-site-implement-bimi" id="should-your-site-implement-bimi">Should your site implement BIMI?</a>
</h1>
<p id="rfc.section.3.p.1">If your site satisfies the <a href="#bimi-site-requirements" class="xref">Section 6.1</a>, this is likely a "yes".  </p>
<p id="rfc.section.3.p.2">As email has evolved over the past three decades, it is no longer a medium of merely exchanging text, but of enabling people to build rich experiences on top of it. BIMI provides an incentive for brands to send email more securely because the desired behavior - a visual imprint in the inbox - first requires DMARC adoption.  </p>
<h1 id="rfc.section.4">
<a href="#rfc.section.4">4.</a> <a href="#terminology-1" id="terminology-1">Terminology</a>
</h1>
<p id="rfc.section.4.p.1">The following terms are used throughout this document.  </p>
<p></p>

<ul>
<li>MTA</li>
<li>MUA</li>
<li>DKIM</li>
<li>SPF</li>
<li>DMARC</li>
<li>Alignment</li>
<li>Verified Mark Certificate (VMC)</li>
<li>Recipient Domain</li>
<li>Sending Domain</li>
<li>MVA</li>
</ul>

<p> </p>
<p id="rfc.section.4.p.3">For definitions of these terms, see the Appendix.  </p>
<h1 id="rfc.section.5">
<a href="#rfc.section.5">5.</a> <a href="#site-implementations" id="site-implementations">Site implementations</a>
</h1>
<p id="rfc.section.5.p.1">In order for a site to correctly implement BIMI, the receiver must be able to perform the following: </p>
<p></p>

<ul>
<li>Validate SPF</li>
<li>Validate DKIM signatures</li>
<li>Validate DMARC</li>
<li>Discover and fetch a BIMI assertion record using DNS</li>
<li>Fetch a SVG using HTTPS</li>
<li>Validate a SVG using a profile</li>
<li>Add Authentication-Results and BIMI-* Headers to a message</li>
</ul>

<p> </p>
<p id="rfc.section.5.p.3">Optionally, for a site to correctly implement BIMI Verified Mark Certificate (VMC) verification, the receiver must be able to perform the following: </p>
<p></p>

<ul>
<li>Fetch a VMC using HTTPS</li>
<li>Validate a VMC (a new kind of Extended Validation (EV) certificate)</li>
<li>Extract a SVG from a VMC</li>
</ul>

<p> </p>
<p id="rfc.section.5.p.5">A site may wish to implement URI alteration and image caching for hosted recipients.  By implementing BIMI, a site agrees that through some combination of trust mechanisms, it will instruct a BIMI-capable MUA to display the image fetched from a URI within the message headers. This URI is created after the MTA authenticates a message, and is also able to authenticate the VMC associated with the sending domain.  Discussion of these trust mechanisms is beyond the scope of this document.  </p>
<h1 id="rfc.section.6">
<a href="#rfc.section.6">6.</a> <a href="#validation-of-a-bimi-message" id="validation-of-a-bimi-message">Validation of a BIMI message</a>
</h1>
<h1 id="rfc.section.6.1">
<a href="#rfc.section.6.1">6.1.</a> <a href="#bimi-site-requirements" id="bimi-site-requirements">BIMI Site Requirements</a>
</h1>
<p id="rfc.section.6.1.p.1">In the BIMI specification, a message MUST be authenticated via DMARC. As stated in the DMARC draft, this requires that only one of DKIM or SPF must successfully pass validation with alignment with the organizational domain in the From: address.  However, for additional local security measures, a receiving site may choose to create additional requirements for senders in order to verify BIMI  (that is, indicate to a downstream MUA that it is safe to load a BIMI logo in the email client) </p>
<p id="rfc.section.6.1.p.2">This may include, but is not limited to: </p>
<p></p>

<ul>
<li>Requiring both DKIM and SPF to validate and align with the organizational domain in the From: address (whereas DMARC only requires one of SPF or DKIM to align with the From: domain)</li>
<li>SPF "strength" requirements (e.g., requiring "-all", disallowing usage of "?all" or not allowing inclusion of overly large address spaces)</li>
<li>SMTP delivery via TLS</li>
<li>Feedback Loop registration or other method of registration with the receiving site</li>
<li>Domain reputation via a DNS allow list or other reputation system</li>
</ul>

<p> </p>
<p id="rfc.section.6.1.p.4">These localized requirements are at the discretion of the receiving site. In general, the stricter the criteria, the less chance there is of an MUA erroneously showing a logo and giving the wrong signal to a user.  </p>
<p id="rfc.section.6.1.p.5">Upon receipt of an email, a receiver that implements BIMI should remove or rename any previously existing BIMI-* headers other than BIMI-Selector, as they may have come from an attacker (as long as the BIMI-Selector is covered by the DKIM signature; if not, it should be removed, renamed, or ignored).  </p>
<p id="rfc.section.6.1.p.6">Additionally: </p>
<p></p>

<ul>
<li>It may be useful to have messages exiting a site to have those BIMI-* headers removed as well.</li>
<li>It is useful for a site that has not implemented BIMI to remove those headers so that an MUA that does make use of those headers would not accidentally display a BIMI image when the message has not been properly authenticated by the email receiver (even though an MUA should not make use of BIMI headers and instead rely upon settings from the mailstore, it is possible that some MUAs will nevertheless use headers without taking appropriate precautions).</li>
</ul>

<p> </p>
<h1 id="rfc.section.6.2">
<a href="#rfc.section.6.2">6.2.</a> <a href="#verified-mark-certificate-vmc-validation" id="verified-mark-certificate-vmc-validation">Verified Mark Certificate (VMC) Validation</a>
</h1>
<p id="rfc.section.6.2.p.1">(Currently, see document in Reference below) </p>
<h1 id="rfc.section.7">
<a href="#rfc.section.7">7.</a> <a href="#communicating-bimi-results-between-the-mta-and-the-mua" id="communicating-bimi-results-between-the-mta-and-the-mua">Communicating BIMI results between the MTA and the MUA</a>
</h1>
<p id="rfc.section.7.p.1">In order for a receiver that has implemented BIMI to notify an MUA that it should display the images: </p>
<p></p>

<ul><li>An MTA must verify BIMI, and if it passes, add additional headers containing the logo to be displayed.</li></ul>

<p> </p>
<p id="rfc.section.7.p.3">The MUA must check to see if a message passed BIMI before loading the BIMI image.  </p>
<p id="rfc.section.7.p.4">While the MTA MAY stamp BIMI-related information in the message headers, they should not be relied upon by an MUA without additional checks to make sure they were added by a trusted source, for example, making sure the MTA strips existing headers on ingress, or by checking for a bimi pass in a trusted Authentication-Results header.  </p>
<h1 id="rfc.section.7.1">
<a href="#rfc.section.7.1">7.1.</a> <a href="#image-retrieval" id="image-retrieval">Image Retrieval</a>
</h1>
<p id="rfc.section.7.1.p.1">A core part of the BIMI specification is that the MUA will retrieve an image file to display for each BIMI-validated message. There are multiple ways to accomplish this, for example: </p>
<p></p>

<ul>
<li>In its most basic setup, a BIMI-capable MUA could retrieve the image file directly from the site specified in the BIMI-Location header.</li>
<li>A BIMI capable MTA will add a header containing the Base64 encoded SVG of the image file.  The MUA can use this header to retrieve the already validated image file for display. This is the recommended method of image retrieval as the work of retrieval and validation has already been done by the MTA.</li>
<li>Other providers may choose to cache the associated images in a local store which could be used as the BIMI resource address in the headers of a BIMI-approved message in a sort of proxy configuration.</li>
</ul>

<p> </p>
<h1 id="rfc.section.7.2">
<a href="#rfc.section.7.2">7.2.</a> <a href="#ttl-of-cached-images" id="ttl-of-cached-images">TTL of cached images</a>
</h1>
<p id="rfc.section.7.2.p.1">In some circumstances it is necessary to cache the images that an MUA would want to load.  For example, if a domain owner has a short TTL time, it would force the MUA to look it up in an unreasonably short period of time. In this case, a receiver may want to set its own TTL.  </p>
<p id="rfc.section.7.2.p.2">One option is to set it to several hours, or a day; another option is to set the TTL to the same as the expiration period in the VMC that contains the BIMI image. The downside is that the caching mechanism might need to check for certificate revocation, and then re-fetch images.  </p>
<h1 id="rfc.section.7.3">
<a href="#rfc.section.7.3">7.3.</a> <a href="#image-display" id="image-display">Image Display</a>
</h1>
<p id="rfc.section.7.3.p.1">Although BIMI does not define an aspect ratio for Brand Indicators it is expected that the majority of receivers will display them in a square or circular space. Is it recommended to brands that their Indicators should be constructed to display in a 1:1 aspect ratio, receivers should design the user interface display for BIMI Indicators with this in mind.  </p>
<h1 id="rfc.section.7.4">
<a href="#rfc.section.7.4">7.4.</a> <a href="#privacy-concerns" id="privacy-concerns">Privacy Concerns</a>
</h1>
<p id="rfc.section.7.4.p.1">There is some concern that the retrieval of the iconography could result in a privacy leak.  <br> As the images are retrieved, it's possible that the image provider could track the retrieving system in some way. This has implications whether it be the sender or provider that is hosting the image. For example, a sender could include a singular selector for a single recipient, or a provider could append a tracking string to the image URI in the header.  </p>
<p id="rfc.section.7.4.p.2">A receiver may choose to track the number of selectors an organizational domain is permitted to use and deny processing if this exceeds a defined limit. Similarly, a receiver may choose to track and limit distinct Indicator URLs.  </p>
<p id="rfc.section.7.4.p.3">MTAs are encouraged to cache BIMI Records, VMCs, and Indicators to limit tracking.  </p>
<p id="rfc.section.7.4.p.4">MUAs are encouraged to extract Indicators from the BIMI-Indicator header rather than retrieving them directly from the source, as doing so will limit any data exposure to the MTA processing the message. The BIMI approved SVG profile prohibits an SVG from loading external elements, this removes the risk of tracking when an Indicator is shown in the client.  </p>
<p id="rfc.section.7.4.p.5">An in-depth discussion of all the potential privacy leaks with respect to loading or embedding images is outside the scope of this document.  </p>
<h1 id="rfc.section.7.5">
<a href="#rfc.section.7.5">7.5.</a> <a href="#basic-flow-example" id="basic-flow-example">Basic flow example</a>
</h1>
<p id="rfc.section.7.5.p.1">One sample implementation of BIMI by a receiver, who does everything on-the-fly, is as following: </p>
<p></p>

<ul>
<li>Upon receipt of a message, the receiver checks to see if the message passes aligned-SPF or DKIM, and DMARC, and ensures that the sending domain has a DMARC policy of <samp>quarantine</samp> or <samp>reject</samp> per local receiver policy, while properly applying the appropriate DMARC policy to the message.</li>
<li>If the message passes prior checks, the receiver will then check to see if the domain in the From: address has a BIMI record (or, if the message has a BIMI-Selector header that is covered by the DKIM-Signature, uses that to do the BIMI query in DNS).</li>
<li>If a BIMI record is found, the receiver then retrieves the VMC from the location that the BIMI record points to, and attempts to verify the VMC using a trusted root certificate. .</li>
<li>Upon successful verification of the VMC, the receiver extracts the verified image from the VMC. If the SVG also passes the SVG validation steps then this is a successful BIMI verification.</li>
<li>If the BIMI verification fails then the MTA must not indicate to the MUA to show a BIMI image. The MUA MAY show a default image such as a set of initials, or unidentified sender.</li>
<li>The email receiver then does the rest of its anti-spam, anti-malware, and anti-phishing checks as discussed in <a href="#message-classification" class="xref">Section 7.6</a> below.</li>
<li>The email receiver then adds the relevant Authentication-Results and BIMI-* headers to the message to signal to the downstream email client that the message passed BIMI and that is safe to load the logo.</li>
<li>Eventually, the MUA checks the BIMI-* headers, decodes the image in the BIMI-Indicator header, and displays it as the sender photo (or however else it chooses to render the BIMI logo in conjunction with the message).</li>
</ul>

<p> </p>
<h1 id="rfc.section.7.6">
<a href="#rfc.section.7.6">7.6.</a> <a href="#message-classification" id="message-classification">Message Classification</a>
</h1>
<p id="rfc.section.7.6.p.1">The successful validation of BIMI does NOT indicate that a message is not spam, malware, or phishing.  </p>
<p id="rfc.section.7.6.p.2">It is expected that receivers undertake their usual message filtering and classification steps, and take the results of these checks into consideration when deciding if a BIMI Indicator should be shown to the user.  </p>
<p id="rfc.section.7.6.p.3">If classification is preformed before BIMI is evaluated then a receiver MAY CHOOSE to skip BIMI processing for that message, in this case they SHOULD add a bimi=skipped entry to the Authentication-Results header for that message, and SHOULD add a comment stating the reasons for skipping BIMI processing.  </p>
<p id="rfc.section.7.6.p.4">If a message is classified as phishing or malware then the MUA SHOULD NOT display the logo.  </p>
<p id="rfc.section.7.6.p.5">If a message is classified as spam (meaning that the message comes from a known brand, but contains spammy content), then the email receiver MAY choose not to display the logo.  </p>
<h1 id="rfc.section.8">
<a href="#rfc.section.8">8.</a> <a href="#domain-reputation" id="domain-reputation">Domain Reputation</a>
</h1>
<p id="rfc.section.8.p.1">Receivers are advised to consider incorporating local sources of domain trust intelligence into the processes which ultimately determine whether or not BIMI logos are displayed.  Simply because a sending domain passes BIMI requirements does not mean the images should automatically be displayed in the MUA; a site may impose further restrictions based on domain reputation.  </p>
<p id="rfc.section.8.p.2">One source of additional reputation intelligence could be a platform that the email provider has created to calculate domain trust based on historical traffic; another is an explicit list of trusted domains that has been curated by an individual provider; a third is a list that is purchased from a vendor that might be a pass/fail or a scored list; another option is some mix of any of the previous three.  </p>
<h1 id="rfc.section.8.1">
<a href="#rfc.section.8.1">8.1.</a> <a href="#rolling-up-based-upon-domain-vs-organizational-domain" id="rolling-up-based-upon-domain-vs-organizational-domain">Rolling up based upon domain vs organizational domain</a>
</h1>
<p id="rfc.section.8.1.p.1">BIMI is designed to be able to work on selectors, and so in theory a brand/domain could specify multiple BIMI logos and differentiate them on a per-domain (per-selector) basis. The advantage for the brand is that they can choose the image they want the user to see depending upon various conditions (e.g., seasonal images, regional images, etc.).  </p>
<p id="rfc.section.8.1.p.2">However, for an email receiver, it may be easier to roll up BIMI logos on an organizational domain basis. One reason may be for the purposes of reputation, another may be for simplifying management of images. In this case, it would need to be made clear to brands that this is how the loading of BIMI images works. This documentation could live on a postmaster site, under technical documentation, or other official page maintained by the receiver. It could then be referred to when sending organizations ask about how to on-board to BIMI at the receiver, and provide official guidance about the way it works at the site.  </p>
<p id="rfc.section.8.1.p.3">If rolling up by organizational domain, then it may make sense to use a "lowest common denominator" approach. That is, an organizational domain must meet all the requirements for BIMI, rather than only a subdomain. The reason for this is that if sub.brand.com gets an image due to having strong authentication policies, but brand.com does not, then this may cause confusion because a user may learn to associate sub.brand.com and its image with brand.com; and if brand.com can be spoofed even though sub.brand.com cannot, that can lead to users becoming more susceptible to phishing from brand.com.  </p>
<p id="rfc.section.8.1.p.4">To alleviate this, receivers may wish to show logos only for domains that have organizational domains with strong DMARC policies. Or, if an organizational domain does not have a strong DMARC policy but a subdomain does, then it may treat the organizational domain as if it does have a strong DMARC policy so as to prevent a phisher or spammer from impersonating the brand or any of its subdomains.  </p>
<p id="rfc.section.8.1.p.5">A strong DMARC policy may be defined as one which has some level of enforcement. ie, a p=quarantine policy with an effective pct=100, or a p=reject policy.  </p>
<h1 id="rfc.section.8.2">
<a href="#rfc.section.8.2">8.2.</a> <a href="#vmc-root-of-trust" id="vmc-root-of-trust">VMC Root of Trust</a>
</h1>
<p id="rfc.section.8.2.p.1">VMCs are verified back to their issuing Certificate Authority (CA). Receivers may wish to maintain their own list of trusted CAs for BIMI rather than relying on a generally available bundle of trusted Root Certificates such as those distributed with browsers or operating systems. The Authindicators Working Group will maintain a list of known VMC Root CA Certificates to help bootstrap such a list.  </p>
<h1 id="rfc.section.9">
<a href="#rfc.section.9">9.</a> <a href="#bimi-playbook-checklist" id="bimi-playbook-checklist">BIMI Playbook Checklist</a>
</h1>
<p id="rfc.section.9.p.1">There are several factors to consider for email receivers on things that can go wrong; below are a handful of considerations: </p>
<p></p>

<ul>
<li>Failing to verify a VMC</li>
<li>Failing to extract an Indicator from a validated VMC</li>
<li>Failing to validate a SVG against the recommended profile</li>
<li>Failing to parse a gzipped SVG Indicator</li>
<li>Failing to load a logo in the email client</li>
<li>Failing to access the logo (e.g., permissions errors)</li>
<li>Connectivity problems to the logo</li>
<li>Failing to display a correct logo in the email client</li>
<li>Having the wrong logo stored for a brand (i.e., uploading it to a local store but associating it with the wrong brand)</li>
<li>Caching a logo for too long after it has updated</li>
</ul>

<p> </p>
<p id="rfc.section.9.p.3">There are many reasons why a logo may fail to load; having tools to investigate (logs, headers in messages, internal documentation that is clearly written, having the knowledge pushed out to multiple escalation channels) is important for investigation.  </p>
<h1 id="rfc.section.10">
<a href="#rfc.section.10">10.</a> <a href="#public-documentation" id="public-documentation">Public documentation</a>
</h1>
<h1 id="rfc.section.10.1">
<a href="#rfc.section.10.1">10.1.</a> <a href="#documentation-for-brands" id="documentation-for-brands">Documentation For Brands:</a>
</h1>
<p id="rfc.section.10.1.p.1">It is ideal to publish the criteria that is used by your site to determine when BIMI will be displayed. It is fine to say that you use some internal domain reputation metrics as additional criteria to determine whether or not a logo should be displayed, and it isn&#8217;t necessary to give away the exact nature of the algorithm other than to say "You must maintain good sending practices." </p>
<p id="rfc.section.10.1.p.2">If you use an explicit allow list, a site may want to list the minimum requirements, and the method of applying to be listed.  Similarly, a provider may wish to state what type of activity will revoke the decision to display logos previously approved.  </p>
<h1 id="rfc.section.10.2">
<a href="#rfc.section.10.2">10.2.</a> <a href="#documentation-for-users" id="documentation-for-users">Documentation For Users:</a>
</h1>
<p id="rfc.section.10.2.p.1">BIMI is not meant to instill additional trust in messages, and it is important to make this known to your users. All messages, even those with logos, should still be treated with (mild) skepticism, and any action regarding the message should still be individually evaluated.  It&#8217;s possible for a site that has a high trust value to become compromised and send fraudulent messages that could compromise a user&#8217;s system. Ensure your customers have a place that documents BIMI and demonstrates how to check messages for fraud.  </p>
<h1 id="rfc.section.11">
<a href="#rfc.section.11">11.</a> <a href="#appendix" id="appendix">Appendix</a>
</h1>
<h1 id="rfc.section.11.1">
<a href="#rfc.section.11.1">11.1.</a> <a href="#glossary" id="glossary">Glossary</a>
</h1>
<p></p>

<ul>
<li>MUA - Mail User Agent - The application used to read messages by the end user.  This could be a thick client or a web-based application.</li>
<li>MTA - Mail Transfer Agent - Software used to transfer messages between two systems, typically between two sites, using SMTP as the protocol.</li>
<li>SPF - <a href="https://tools.ietf.org/html/rfc7208">Sender Policy Framework</a> - SPF is a framework that designates which systems should be sending for a given domain.  This can be a list of IPs, CIDRs, or references to DNS records.  As the sender should be controlling their DNS, they should understand which IPs should be sending as their domain.</li>
<li>DKIM - <a href="https://tools.ietf.org/html/rfc6376">DomainKeys Identified Mail</a> - DKIM is a system by which a chosen set of headers, combined with the message contents, are cryptographically signed, and then validated by the receiving system.  Using DNS, the receiving system can retrieve a public key, and then validate the signature within the headers of a message. When implemented properly, the systems responsible for sending the messages for a given domain name should be the only ones capable of creating messages that correctly validates.</li>
<li>DMARC - <a href="https://tools.ietf.org/html/rfc7489">Domain-based Message Authentication, Reporting, and Conformance</a> - DMARC is a message authentication mechanism that works with SPF and DKIM. The BIMI specification requires that a message passes DMARC. In order for a message to pass DMARC, one of SPF or DKIM must successfully validate, and the domain in the From: address must align with the domain that passed SPF or DKIM.</li>
<li>Alignment - Alignment refers to the organizational domain, as defined by DMARC, of the domain in the From: address being the same as the organizational domain that passed SPF or DKIM. For example, baz.example.com has an organizational domain of example.com; bar.foo.example.com also has an organizational domain of example.com. It aligns with org.example.com, because both have the same organizational domain. A definition of organizational domain and methods of discovery may be found in the <a href="https://tools.ietf.org/html/rfc7489">DMARC</a> RFC.</li>
<li>MVA - Mark Verifying Authority - An entity that a receiver uses to certify that the iconography that they intend to use with BIMI is properly/legally licensed for their use.</li>
<li>DRA - Dispute Resolution Authority - This organization will moderate between two entities that believe they are both entitled to use a logo.  Receivers should then abide by the decision of the DRA as it pertains to logo usage in the MUA.</li>
<li>VMC - Verified Mark Certificate - An Extended Validation Certificate is used in conjunction with BIMI to create a place where information pertaining to iconography for a sending domain can be securely verified. In the case of BIMI, hashes for an MVA-approved set of iconography will be stored in a field within the certificate. This should allow a receiver site to validate the retrieved imagery before putting the BIMI image URI into the message headers.</li>
</ul>

<p> </p>
<h1 id="rfc.section.12">
<a href="#rfc.section.12">12.</a> <a href="#contributors" id="contributors">Contributors</a>
</h1>
<p id="rfc.section.12.p.1">TBD </p>
<h1 id="rfc.section.13">
<a href="#rfc.section.13">13.</a> <a href="#references" id="references">References</a>
</h1>
<p id="rfc.section.13.p.1">The full BIMI verification spec can be found at: <span>&lt;</span><a href="https://github.com/authindicators/rfc-brand-indicators-for-message-identification">https://github.com/authindicators/rfc-brand-indicators-for-message-identification</a><span>&gt;</span> </p>
<p id="rfc.section.13.p.2">Verified Mark Certificates Usage: <span>&lt;</span><a href="https://docs.google.com/document/d/1OzL9FqexZpZJQuoqAK2E3sXjOwEcLNCvXW7e88Olt2I/edit">https://docs.google.com/document/d/1OzL9FqexZpZJQuoqAK2E3sXjOwEcLNCvXW7e88Olt2I/edit</a><span>&gt;</span> </p>
<h1 id="rfc.references">
<a href="#rfc.references">14.</a> Normative References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="RFC2119">[RFC2119]</b></td>
<td class="top">
<a>Bradner, S.</a>, "<a href="https://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>", BCP 14, RFC 2119, DOI 10.17487/RFC2119, March 1997.</td>
</tr>
<tr>
<td class="reference"><b id="RFC8174">[RFC8174]</b></td>
<td class="top">
<a>Leiba, B.</a>, "<a href="https://tools.ietf.org/html/rfc8174">Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words</a>", BCP 14, RFC 8174, DOI 10.17487/RFC8174, May 2017.</td>
</tr>
</tbody></table>
<h1 id="rfc.authors"><a href="#rfc.authors">Authors' Addresses</a></h1>
<div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Alex Brotman</span> 
	  <span class="n hidden">
		<span class="family-name">Brotman</span>
	  </span>
	</span>
	<span class="org vcardline">Comcast</span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality"></span> 
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline"></span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:alex_brotman@comcast.com">alex_brotman@comcast.com</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Terry Zink</span> 
	  <span class="n hidden">
		<span class="family-name">Zink</span>
	  </span>
	</span>
	<span class="org vcardline">Zink Magical Contraptions</span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality"></span> 
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline"></span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:tzink@terryzink.com">tzink@terryzink.com</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Marc Bradshaw</span> 
	  <span class="n hidden">
		<span class="family-name">Bradshaw</span>
	  </span>
	</span>
	<span class="org vcardline">Fastmail</span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality"></span> 
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline"></span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:marc@fastmailteam.com">marc@fastmailteam.com</a></span>

  </address>
</div>

</body>
</html>
